<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>JVM 运行时内存 | 一兜小白菜</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/learning_blog/logo.png">
    <meta name="description" content="learning something">
    <link rel="preload" href="/learning_blog/assets/css/0.styles.292e88f6.css" as="style"><link rel="preload" href="/learning_blog/assets/js/app.a4dcdc72.js" as="script"><link rel="preload" href="/learning_blog/assets/js/2.15fb6e89.js" as="script"><link rel="preload" href="/learning_blog/assets/js/16.c19fb499.js" as="script"><link rel="prefetch" href="/learning_blog/assets/js/10.625d3583.js"><link rel="prefetch" href="/learning_blog/assets/js/11.39b55b78.js"><link rel="prefetch" href="/learning_blog/assets/js/12.8c71ddec.js"><link rel="prefetch" href="/learning_blog/assets/js/13.dcfb532c.js"><link rel="prefetch" href="/learning_blog/assets/js/14.3a208a6d.js"><link rel="prefetch" href="/learning_blog/assets/js/15.c1827914.js"><link rel="prefetch" href="/learning_blog/assets/js/17.5e4e5795.js"><link rel="prefetch" href="/learning_blog/assets/js/18.46608703.js"><link rel="prefetch" href="/learning_blog/assets/js/19.5100b952.js"><link rel="prefetch" href="/learning_blog/assets/js/20.79a98d11.js"><link rel="prefetch" href="/learning_blog/assets/js/21.bb14ac69.js"><link rel="prefetch" href="/learning_blog/assets/js/22.78e0dbe7.js"><link rel="prefetch" href="/learning_blog/assets/js/23.86119b81.js"><link rel="prefetch" href="/learning_blog/assets/js/3.28069a0d.js"><link rel="prefetch" href="/learning_blog/assets/js/4.5e7fb7ae.js"><link rel="prefetch" href="/learning_blog/assets/js/5.37bbb6e5.js"><link rel="prefetch" href="/learning_blog/assets/js/6.adfa8de6.js"><link rel="prefetch" href="/learning_blog/assets/js/7.75144e26.js"><link rel="prefetch" href="/learning_blog/assets/js/8.2ad448e8.js"><link rel="prefetch" href="/learning_blog/assets/js/9.691c2ab5.js">
    <link rel="stylesheet" href="/learning_blog/assets/css/0.styles.292e88f6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/learning_blog/" class="router-link-active home-link"><img src="/learning_blog/logo.png" alt="一兜小白菜" class="logo"> <span class="site-name">一兜小白菜</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/learning_blog/" class="router-link-active">
          Home
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-submenu-selected"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          Java Learning
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/learning_blog/go/">
          Go Learning
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/learning_blog/spring/">
          Spring Learning
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/learning_blog/architect/">
          软件架构师
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <!----></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><a href="/learning_blog/java/jvm/" aria-current="page" title="JVM learning" class="sidebar-link">JVM learning</a></li><li><a href="/learning_blog/java/jvm/线程.html" title="线程" class="sidebar-link">线程</a></li><li><a href="/learning_blog/java/jvm/JVM 内存区域.html" title="JVM 内存区域" class="sidebar-link">JVM 内存区域</a></li><li><a href="/learning_blog/java/jvm/JVM 运行时内存.html" title="JVM 运行时内存" class="active sidebar-link">JVM 运行时内存</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learning_blog/java/jvm/JVM 运行时内存.html#新生代" title="新生代" class="sidebar-link">新生代</a></li><li class="sidebar-sub-header"><a href="/learning_blog/java/jvm/JVM 运行时内存.html#老年代" title="老年代" class="sidebar-link">老年代</a></li><li class="sidebar-sub-header"><a href="/learning_blog/java/jvm/JVM 运行时内存.html#永久代" title="永久代" class="sidebar-link">永久代</a></li></ul></li><li><a href="/learning_blog/java/jvm/垃圾回收与算法.html" title="垃圾回收与算法" class="sidebar-link">垃圾回收与算法</a></li><li><a href="/learning_blog/java/jvm/Java 四种引用类型.html" title="Java 四种引用类型" class="sidebar-link">Java 四种引用类型</a></li><li><a href="/learning_blog/java/jvm/GC 分代收集算法 VS 分区收集算法.html" title="GC 分代收集算法 VS 分区收集算法" class="sidebar-link">GC 分代收集算法 VS 分区收集算法</a></li><li><a href="/learning_blog/java/jvm/GC 垃圾收集器.html" title="GC 垃圾收集器" class="sidebar-link">GC 垃圾收集器</a></li><li><a href="/learning_blog/java/jvm/Java IO&amp;NIO.html" title="Java IO/NIO" class="sidebar-link">Java IO/NIO</a></li><li><a href="/learning_blog/java/jvm/JVM 类加载机制.html" title="JVM 类加载机制" class="sidebar-link">JVM 类加载机制</a></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h1 id="jvm-运行时内存"><a href="#jvm-运行时内存" class="header-anchor">#</a> JVM 运行时内存</h1> <p>Java 堆从 GC 的角度还可以细分为：<strong>新生代</strong>（Eden 区、From survivor 区和 To Survivor 区）和<strong>老年代</strong>。</p> <img src="/learning_blog/img/java/jvm/JVM运行时内存.png" alt="JVM运行时内存"> <h2 id="新生代"><a href="#新生代" class="header-anchor">#</a> 新生代</h2> <p>新生代是用来存放新生的对象。一般占据堆的 1/3 空间.由于频繁创建对象，所以新生代会频繁触发 MinorGC 进行垃圾回收。新生代又分为 Eden 区、ServivorFrom、ServivorTo 三个区。</p> <h3 id="eden-区"><a href="#eden-区" class="header-anchor">#</a> Eden 区</h3> <p><font color="#316CA5">Java 新对象的出生地</font>（如果新创建的对象占用内存很大，则直接分配到老年代）。当 Eden 区内存不够的时候就会触发 MinorGC，对新生代区进行一次垃圾回收。</p> <h3 id="servivorfrom"><a href="#servivorfrom" class="header-anchor">#</a> ServivorFrom</h3> <p>上一次 GC 的幸存者，作为这一次 GC 的被扫描者。</p> <h3 id="servivorto"><a href="#servivorto" class="header-anchor">#</a> ServivorTo</h3> <p>保留了一次 MinorGC 过程中的幸存者。</p> <h3 id="minorgc-的过程-复制-清空-互换"><a href="#minorgc-的过程-复制-清空-互换" class="header-anchor">#</a> MinorGC 的过程（复制 -&gt; 清空 -&gt; 互换）</h3> <p>MinorGC 采用复制算法。</p> <ol><li><p>Eden、ServivorFrom 复制到 ServivorTo，年龄 +1</p> <p>首先，把 Eden  和 ServivorFrom 区域中存活的对象复制到 ServivorTo 区域（如果有对象的年龄以及达到了老年的标准，则赋值到老年代区），同时把这些对象的年龄+1（如果 ServivorTo 不够位置了就放到老年区）</p></li> <li><p>清空 Eden、ServivorFrom</p> <p>然后，清空 Eden 和 ServivorFrom 中的对象</p></li> <li><p>ServivorTo 和 ServivorFrom 互换</p> <p>最后，ServivorTo 和 ServivorFrom 互换，原 ServivorTo 成为下一次 GC 时的 ServivorFrom 区。</p></li></ol> <h2 id="老年代"><a href="#老年代" class="header-anchor">#</a> 老年代</h2> <p>主要存放应用程序中生命周期长的内存对象。</p> <p>老年代的对象比较稳定，所以 MajorGC 不会频繁执行。在进行 MajorGC 前一般都先进行了一次 MinorGC，使得有新生代的对象进入老年代，导致空间不够用时才触发。当无法找到足够大的连续空间分配给新创建的较大对象时也会提前触发一次 MajorGC 进行垃圾回收腾出空间。</p> <p>MajorGC 采用标记清楚算法：首先扫描一次所有老年代，标记处存储的对象，然后回收没有标记的对象。MajorGC 的耗时比较长，因为要扫描再回收。MajorGC 会产生内存碎片，为了减少内存损耗，我们一般需要进行合并或者标记出来方便下次直接分配。当老年代也装不下的时候，就会抛出 OOM（Out Of Memory）异常。</p> <h2 id="永久代"><a href="#永久代" class="header-anchor">#</a> 永久代</h2> <p>永久代指内存的永久保存区域，主要存放 Class 和 Meta（元数据）的信息，Class 在被加载的时候被放入永久区域，它和存放实例的区域不同，<font color="#316CA5">GC 不会在主程序运行期对永久区进行清理</font>。所以这也导致了永久代的区域会随着加载的 Class 的增多而胀满，最终抛出 OOM 异常。</p> <h3 id="java-8-与元数据"><a href="#java-8-与元数据" class="header-anchor">#</a> Java 8 与元数据</h3> <p>在 Java8 中，<font color="#24B0EF">永久代已经被移除，被一个称为“元数据区”（元空间）的区域所取代</font>。元空间的本质和永久代类似，元空间与永久代之间最大的区别在于：<font color="#316CA5">元空间并不在虚拟机中，而是使用本地内存</font>。因此，默认情况下，元空间的大小仅受本地内存限制。<font color="#316CA5">类的元数据放入 Native Memroy，字符串池和类的静态变量放入 Java 堆中，</font>这样可以加载多少类的元数据就不再由 MaxPermSize 控制，而由系统的实际可用空间来控制。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/learning_blog/java/jvm/JVM 内存区域.html" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        JVM 内存区域
      </a></span> <span class="next"><a href="/learning_blog/java/jvm/垃圾回收与算法.html">
        垃圾回收与算法
        <i aria-label="icon: right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></span></p></div> </main> <!----></div><div class="global-ui"></div></div>
    <script src="/learning_blog/assets/js/app.a4dcdc72.js" defer></script><script src="/learning_blog/assets/js/2.15fb6e89.js" defer></script><script src="/learning_blog/assets/js/16.c19fb499.js" defer></script>
  </body>
</html>