# 单例模式

**定义**：确保一个类只有一个实例，而且自行实例化并向整个系统提供这个实例。

**类型**：创建类模式

**类图**：

<img :src="$withBase('/img/java/design/singleton类图.png')" alt="singleton类图">

单例模式应该是 23 种设计模式种最简单的一种模式了。它有以下几个要素：

* 私有的构造方法

* 指向自己的实例的私有静态引用

* 以自己实例为返回值的静态的共有的方法

单例模式根据实例化对象时机不同分为两种：一种是饿汉式单例，一种是懒汉式单例。饿汉式单例在单例类被加载时，就实例化一个对象交给自己的引用；而懒汉式在调用取得实例方法的时候才会实例化对象。代码如下：

### 饿汉式单例

```java
public class Singleton {

    private static Singleton singleton = new Singleton();
    
    private Singleton(){
    }
    
    public static Singleton getInstance(){
        return singleton;
    }
}
```

### 懒汉式单例

```java
public class Singleton {

    private static Singleton singleton;
    
    private Singleton(){
    }
    
    public static synchronized Singleton getInstance(){
        if(singleton==null){
            singleton = new Singleton();
        }
        return singleton;
    }
}
```


### 单例模式的优点

* 在内存中只有一个对象，节省内存空间；

* 避免频繁地创建销毁对象，可以提供性能；

* 避免对共享资源的多重占用；

* 可以全局访问。

### 适用场景

由于单例模式的已上优点，所以是编码种用的比较多的一种设计模式。其适用场景总结如下：

* 需要频繁实例化然后销毁的对象；

* 创建对象时耗时过多或者消耗资源过多，但又经常用到的对象；

* 有状态的工具类对象；

* 频繁访问数据库或文件的对象。


### 单例模式注意事项

* 只能使用单例类提供的方法得到单例对象，不要使用反射，否则将会实例化一个新对象；

* 不要做断开单例类对象与类中静态引用的危险操作；

* 多线程场景中，使用单例需要注意线程安全问题。
